# AI Birthday Card Generator - 会员等级体系

## 会员等级概览

| 功能特权           | 免费用户 | 高级会员 | 专业会员 |
|------------------|---------|---------|---------|
| 模板使用          | 是      | 是      | 是      |
| 生成新模板          | 3次/每日| 1000次/每月| 3000次/每月    |
| 批量生成          | 否       | 是      | 是     |
| 广告展示           | 有      | 无      | 无      |
| 模型质量           | 基础    | 高级     | 高级    |
| 多轮生成           | 否     | 3次     | 5次     |
| 隐私模式           | 否      | 是      | 是      |
| 优先生成队列        | 否      | 是      | 是      |
| 定价（月）          | 免费    | $6.99  | $16.99  |
| 定价（年）          | 免费    | $69.99  | $169.99  |
｜一次性额外赠送不限时次数 ｜ 0次 ｜ 100次 ｜ 1000次 ｜

## 系统实现方案

### 1. 数据模型设计

#### 1.1 核心模型

1. **用户表 (User)**
   - 基本用户信息
   - 当前计划类型 (FREE/BASIC/PREMIUM)
   - 关联订阅信息

2. **订阅表 (Subscription)**
   - 用户订阅状态
   - 计费周期（月付/年付）
   - 订阅开始和结束时间
   - 下次计费时间
   - 取消状态管理

3. **功能特权表 (PlanFeature)**
   - 功能名称和描述
   - 功能唯一标识符
   - 关联的使用限制

4. **使用限制表 (PlanLimit)**
   - 每个计划的具体限制值
   - 限制类型（每日/每月/布尔值）
   - 关联到具体功能

5. **额外奖励表 (BonusCredit)**
   - 用户额外获得的使用次数
   - 奖励来源和过期时间
   - 使用状态跟踪

6. **使用记录表 (ApiUsage)**
   - 每日使用统计
   - 用户ID关联
   - 使用时间戳

### 2. 功能特权管理

#### 2.1 特权类型
- daily_generations: 每日生成限制
- monthly_generations: 每月生成限制
- batch_generation: 批量生成能力
- priority_queue: 优先生成队列
- advanced_editing: 高级编辑功能
- api_access: API访问权限

#### 2.2 限制类型
- daily: 每日限制（如生成次数）
- monthly: 每月限制（如总生成次数）
- boolean: 功能开关（如优先队列）

### 3. API接口设计

#### 3.1 用户计划查询接口 (/api/user-plan)
返回数据包括：
- 当前计划信息
- 订阅状态详情
- 使用限制和剩余次数
- 可用功能列表

#### 3.2 功能检查接口 (/api/check-feature)
- 检查用户是否可以使用特定功能
- 返回剩余使用次数和限制信息
- 处理不同类型的限制逻辑

### 4. 实用工具函数

#### 4.1 计划特权检查
```typescript
async function checkPlanFeature(userId: string, featureKey: string): Promise<PlanFeatureCheck>
```
- 检查用户权限
- 计算剩余使用次数
- 返回详细的限制信息

#### 4.2 计划功能获取
```typescript
async function getPlanFeatures(planType: PlanType): Promise<PlanFeature[]>
```
- 获取特定计划的所有功能
- 包含限制和描述信息

### 5. 定价常量
```typescript
const PLAN_PRICES = {
  FREE: { monthly: 0, yearly: 0 },
  BASIC: { monthly: 6.99, yearly: 69.99 },
  PREMIUM: { monthly: 16.99, yearly: 169.99 }
}
```

### 6. 实现注意事项

1. **性能优化**
   - 使用缓存减少数据库查询
   - 批量更新使用记录
   - 异步处理非关键操作

2. **安全考虑**
   - 严格的权限检查
   - 防止绕过限制
   - 异常处理和日志记录

3. **用户体验**
   - 清晰的限制提示
   - 优雅的升级引导
   - 实时的使用统计

4. **扩展性**
   - 支持新功能添加
   - 灵活的限制配置
   - 可定制的计划类型

### 7. 后续计划

1. **功能增强**
   - 更多的计划类型
   - 自定义限制规则
   - 团队版本支持

2. **运营工具**
   - 使用统计分析
   - 转化率跟踪
   - 用户行为分析

3. **营销功能**
   - 推荐奖励系统
   - 限时促销支持
   - 用户等级体系

## 详细功能说明

### 1. 生成次数
- **免费用户**: 每日3次免费生成机会，体验基本功能
- **高级会员**: 每日10次，满足个人日常使用需求
- **专业会员**: 每日30次，适合商业用户和高频使用场景

### 2. 批量生成
- **免费用户**: 每次只能生成1张卡片
- **高级会员**: 每次可同时生成3张不同风格
- **专业会员**: 每次可同时生成5张不同风格

### 3. 模型质量
- **免费用户**: 基础模型，生成时间约15秒
- **高级会员**: 高级模型，生成时间约7秒
- **专业会员**: 最高质量模型，生成时间约5秒

### 4. 高级功能
- **多轮编辑**: 每张卡片可进行的编辑次数（消耗生成次数）
  - 免费用户：1次编辑机会
  - 高级会员：3次编辑机会
  - 专业会员：5次编辑机会
- **优先生成队列**: 高级会员及以上享受优先生成特权
- **高级编辑功能**: 高级会员及以上可使用高级图片编辑功能
- **API访问**: 仅专业会员可以通过API集成到自己的应用中

### 5. 其他特权
- **广告移除**: 所有付费会员均无广告展示
- **专属客服**: 所有付费会员享受优先客服支持
- **自定义模板**: 专业会员可以创建和保存自定义模板

## 技术实现建议

### 1. 数据库设计
```typescript

```

### 3. 性能优化
- 使用Redis缓存用户每日配额信息
- 实现异步队列系统，支持优先级生成
- 针对不同会员等级使用不同的计算资源池

## 营销建议

1. **转化策略**
   - 免费用户提供每日固定次数，让用户养成使用习惯
   - 高级会员针对个人用户，提供充足的每日使用量
   - 专业会员面向商业用户，提供完整解决方案

2. **促销活动**
   - 新用户首周高级会员体验
   - 年付享受优惠折扣
   - 节日特别优惠活动
   - 推荐计划返现

3. **用户留存**
   - 每日登录奖励额外生成次数
   - 会员专属活动
   - 积分奖励系统
   - 定期推送个性化优惠

// ... existing code for the rest of the sections ...